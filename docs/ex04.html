<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise 4</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Geographic Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="lec01.html">Introduction to the course</a>
    </li>
    <li>
      <a href="lec02.html">Univariate plots</a>
    </li>
    <li>
      <a href="lec03.html">Bivariate plots</a>
    </li>
    <li>
      <a href="lec04.html">Descriptive statistics</a>
    </li>
    <li>
      <a href="lec05.html">Multivariate plots</a>
    </li>
    <li>
      <a href="ggplot2.html">ggplot2 versions of basic plots</a>
    </li>
    <li>
      <a href="lec06.html">Maps in R</a>
    </li>
    <li>
      <a href="lec07.html">Geospatial analysis in R</a>
    </li>
    <li>
      <a href="lec08.html">Data wrangling and matrix algebra</a>
    </li>
    <li>
      <a href="lec09.html">Reference distributions</a>
    </li>
    <li>
      <a href="lec10.html">Statistical inference</a>
    </li>
    <li>
      <a href="lec11.html">Analysis of variance</a>
    </li>
    <li>
      <a href="lec12.html">Regression analysis</a>
    </li>
    <li>
      <a href="lec13.html">More regression analysis</a>
    </li>
    <li>
      <a href="lec14.html">Nonparametric regression</a>
    </li>
    <li>
      <a href="lec15.html">GLMs, GAMs, and CARTs</a>
    </li>
    <li>
      <a href="lec16.html">Principal components and factor analyses</a>
    </li>
    <li>
      <a href="lec17.html">MANOVA and discriminant analysis</a>
    </li>
    <li>
      <a href="lec18.html">Multivariate distances and cluster analysis</a>
    </li>
    <li>
      <a href="lec19.html">High-resolution and high-dimension data</a>
    </li>
    <li>
      <a href="lec20.html">Analysis and visualization of large raster data sets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Exercises</li>
    <li>
      <a href="ex01.html">Exercise 01 -- Getting R and RStudio</a>
    </li>
    <li>
      <a href="ex02.html">Exercise 02 -- Univariate plots</a>
    </li>
    <li>
      <a href="ex03.html">Exercise 03 -- Bivariate plots and descriptive statistics</a>
    </li>
    <li>
      <a href="ex04.html">Exercise 04 -- Multivariate plots</a>
    </li>
    <li>
      <a href="ex05.html">Exercise 05 -- Data wrangling and matrix algebra</a>
    </li>
    <li>
      <a href="ex06.html">Exercise 06 -- CI's, t-tests, ANOVA</a>
    </li>
    <li>
      <a href="ex07.html">Exercise 07 -- Regression analysis</a>
    </li>
    <li>
      <a href="ex08.html">Exercise 08 -- Multivariate analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="packages-and-data.html">Packages and data</a>
    </li>
    <li>
      <a href="vm_inst.html">Virtual machine instructions</a>
    </li>
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="datasets.html">Datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Exercise 4</h1>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>
<span style="color: #00cc00;">NOTE: This page has been revised for Spring 2020, but may undergo further edits.</span>
</p>
<p><strong>Geography 4/595: Geographic Data Analysis</strong><br />
<strong>Spring 2020</strong></p>
<p><strong>Exercise 4: Multivariate Plots</strong><br />
<strong>Finish by Friday, April 24th</strong></p>
<p><strong>1. Introduction</strong></p>
<p><strong>Read through the exercise before attempting to complete it.</strong></p>
<p>The purpose of this exercise is to explore some of the general multivariate plotting procedures available in R, including maps, multivariate plots in particular, conditioning plots (coplots), and Trellis/Lattice graphics.</p>
<p>This exercise uses a number of “R packages” or libraries of functions, data sets, etc. that must be downloaded and installed from “CRAN” (you will need to be connected to the Internet to do this).</p>
<p>For this exercise, you’ll need to install the following packages:</p>
<p><code>classInt</code>, <code>ggplot2</code>, <code>lattice</code>, <code>RColorBrewer</code>, and <code>sf</code>.</p>
<p>The easiest way to do this is to use the Tools &gt; Install Packages menu in RStudio or to repeatedly use the <code>install.packages()</code> function, for example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;classInt&quot;</span>)</a></code></pre></div>
<p>You can check to see if a package has been successfully downloaded and installed by attempting to load the package with the library() function, e.g.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>NOTE: When using the <code>install.packages()</code> function, the name of the package must be surrounded by quotes, but when using the <code>library()</code> function the name of the package is NOT surrounded by quotes.</p>
<p>NOTE: If an error message is produced e.g. <code>Error in library(ggplot2) : There is no package called 'ggplot2'</code> then the download and installation has failed. If R complains about not being able to find a repository, then enter the following at the command line:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">CRAN =</span> <span class="st">&quot;http://cran.us.r-project.org/&quot;</span>) <span class="co"># tell R where to look for packages</span></a></code></pre></div>
<p>Occasionally, it’s a good idea to check if packages have been updated; this can be done by typing.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">update.packages</span>()</a></code></pre></div>
<p>or in RStudio, using Tools &gt; Check for Package Updates… If R produces the message “There are binary versions available, but the source vesions are later:” this implies that the package has recently been updated. You can usually reply “no” to the query.</p>
<p><strong>2. Simple maps</strong></p>
<p>Begin by constructing some simple maps of the Oregon climate-station data <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/csv/orstationc.csv">[orstationc.csv]</a>. (See Section 2 of Exercise 3 for directions on how to download and save these data if they are no longer in your working directory.) Also, before starting, download and save in your working directory the following components of a shape file of Oregon county outlines:</p>
<p><a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/orotl.shp">[orotl.shp]</a> <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/orotl.dbf">[orotl.dbf]</a> <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/orotl.shx">[orotl.shx]</a> <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/orotl.prj">[orotl.prj]</a></p>
<p>To begin, load the libraries:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(classInt) </a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">library</span>(ggplot2) </a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">library</span>(lattice) </a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">library</span>(RColorBrewer) </a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw">library</span>(sf) </a></code></pre></div>
<p>(NOTE: If you do the exercise in different sessions, you’ll have to load the libraries each time.)</p>
<p>Read and attach the climate data:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># read and attach the climate data</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># assume the data file is in your working directory</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">csvfile &lt;-<span class="st"> &quot;/Users/bartlein/Documents/geog495/data/csv/orstationc.csv&quot;</span> </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">orstationc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(csvfile) </a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw">str</span>(orstationc)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">attach</span>(orstationc)</a></code></pre></div>
<p>Read and plot the shapefile:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># read a county outline shape file</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">shapefile &lt;-<span class="st"> &quot;/Users/bartlein/Documents/geog495/data/shp/orotl.shp&quot;</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">orotl_sf &lt;-<span class="st"> </span><span class="kw">st_read</span>(shapefile)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">orotl_sf</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">plot</span>(orotl_sf) <span class="co"># plot the outline</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(orotl_sf), <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Then mapping a single variable is accomplished by executing three “chunks” of R code. By constructing the plot using chunks makes it possible to reuse the code for a differnt variable by editing only the first or second chunk.</p>
<p>Set a variable to plot, and get colors:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># set variable and get colors</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">plotvals &lt;-<span class="st"> </span>pjan <span class="co"># pick a variable to plot</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">plottitle &lt;-<span class="st"> &quot;January Precipitation&quot;</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">nclr &lt;-<span class="st"> </span><span class="dv">8</span> <span class="co"># number of colors</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">plotclr &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(nclr,<span class="st">&quot;BuPu&quot;</span>) <span class="co"># get nclr colors</span></a></code></pre></div>
<p>(Take a look at <code>plotclr</code> to see what the <code>brewer.pal()</code> function did.)</p>
<p>Second chunk, get equal-frequency class intervals.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># find equal-frequency intervals</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">class &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(plotvals, nclr, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">colcode &lt;-<span class="st"> </span><span class="kw">findColours</span>(class, plotclr)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">cutpts &lt;-<span class="st"> </span><span class="kw">round</span>(class<span class="op">$</span>brks, <span class="dt">digits=</span><span class="dv">1</span>)</a></code></pre></div>
<p>(Take a look at <code>class</code>, <code>colcode</code> and <code>cutpoints</code> to see what they are.)</p>
<p>The third block of code makes a map:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># plot the shape file and the selected variable</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(orotl_sf), <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">points</span>(lon, lat, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span>colcode, <span class="dt">cex=</span><span class="dv">2</span>) <span class="co"># add points</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw">points</span>(lon, lat, <span class="dt">cex=</span><span class="dv">2</span>) <span class="co"># draws black line around each point</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">legend</span>(<span class="dt">x=</span><span class="op">-</span><span class="dv">117</span>, <span class="dt">y=</span><span class="fl">43.5</span>, <span class="dt">legend=</span><span class="kw">names</span>(<span class="kw">attr</span>(colcode, <span class="st">&quot;table&quot;</span>)), <span class="co"># add legend</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">    <span class="dt">fill=</span><span class="kw">attr</span>(colcode, <span class="st">&quot;palette&quot;</span>), <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw">title</span>(plottitle) <span class="co"># add the title</span></a></code></pre></div>
<p>Construct maps for several of the climate variables (<code>pjan</code> and <code>tjul</code> in particular). For each variable, you should only need to edit the first chunk, changing the variable being plotted (<code>plotvals &lt;- tjul</code> for example), and the <code>RColorBrewer()</code> palette. For instance, the <code>RdBU</code> palette would would work well for temperature, but the colors will be in the “wrong” order (Red = cold, blue = warm, counterintuitive in our culture). The colors can be reversed using (what else?), the reverse function (<code>rev()</code>, e.g. <code>rev(brewer.pal(nclr,&quot;RdBu&quot;))</code> will reorder the colors from blue to red).</p>
<blockquote>
<p>Q1: Describe the basic patterns and gradients of winter precipitation and summer temperature across the state.</p>
</blockquote>
<p><br> Note that fixed-interval class intervals could be mapped as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># symbol plot -- fixed-interval class intervals</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">plotvals &lt;-<span class="st"> </span>pann</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">title &lt;-<span class="st"> &quot;Oregon Climate Station Data -- Annual Precipitation&quot;</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">subtitle &lt;-<span class="st"> &quot;Fixed-Interval Class Intervals&quot;</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">nclr &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">plotclr &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(nclr<span class="op">+</span><span class="dv">1</span>,<span class="st">&quot;BuPu&quot;</span>)[<span class="dv">2</span><span class="op">:</span>(nclr<span class="op">+</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co"># get color codes</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">class &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(plotvals, nclr, <span class="dt">style=</span><span class="st">&quot;fixed&quot;</span>,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">                        <span class="dt">fixedBreaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">9999</span>))</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">colcode &lt;-<span class="st"> </span><span class="kw">findColours</span>(class, plotclr)</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(orcounty_sf), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">124.5</span>, <span class="dv">-115</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">42</span>,<span class="dv">47</span>))</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="kw">points</span>(lon, lat, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span>colcode, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="kw">points</span>(lon, lat, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="kw">title</span>(<span class="dt">main=</span>title, <span class="dt">sub=</span>subtitle)</a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="kw">legend</span>(<span class="op">-</span><span class="dv">117</span>, <span class="fl">43.5</span>, <span class="dt">legend=</span><span class="kw">names</span>(<span class="kw">attr</span>(colcode, <span class="st">&quot;table&quot;</span>)),</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">       <span class="dt">fill=</span><span class="kw">attr</span>(colcode, <span class="st">&quot;palette&quot;</span>), <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p>A <code>ggplot2</code> version of the maps could be made like this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># ggplot2</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># convert the (continous) temperature values to a factor</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">-6</span>, <span class="dv">-4</span>, <span class="dv">-2</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9999</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">tmp_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">findInterval</span>(orstationc<span class="op">$</span>tjan, cutpts))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">head</span>(<span class="kw">cbind</span>(orstationc<span class="op">$</span>tjan, tmp_factor, cutpts[tmp_factor]))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">## ggplot2 map of temperature</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> orotl_sf, <span class="dt">fill=</span><span class="st">&quot;grey70&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> orstationc, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">color =</span> tmp_factor), <span class="dt">size =</span> <span class="fl">5.0</span> ) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;div&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">aesthetics =</span> <span class="st">&quot;color&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;-8 to -6&quot;</span>, <span class="st">&quot;-6 to -4&quot;</span>, <span class="st">&quot;-4 to -2&quot;</span>, <span class="st">&quot;-2 to 0&quot;</span>, <span class="st">&quot;0 to 2&quot;</span>,</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">                                <span class="st">&quot;2 to 4&quot;</span>, <span class="st">&quot;4 to 6&quot;</span>, <span class="st">&quot;6 to 8&quot;</span>, <span class="st">&quot;&gt; 8&quot;</span>),</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">                     <span class="dt">name =</span> <span class="st">&quot;Annual Temp (C)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Oregon Climate Station Data&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p>Detach the <code>orstationc</code> dataframe:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># detach orstation</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">detach</span>(orstationc)</a></code></pre></div>
<p><strong>3. The coplot</strong></p>
<p>Coplots (or conditioning plots) are probably the most commonly used multipanel plot, and an easy-to-use function is available. The following code creates a coplot for annual temperature, plotted as a function of elevation, given latitude and longitude. Before executing the code, use search() to check to see that orstationc is still attached. If not they can be attached as follows</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">attach</span>(orstationc)</a></code></pre></div>
<p>Here’s the code for the coplot:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">coplot</span>(tann <span class="op">~</span><span class="st"> </span>elev <span class="op">|</span><span class="st"> </span>lon <span class="op">*</span><span class="st"> </span>lat, <span class="dt">number=</span><span class="dv">5</span>, <span class="dt">overlap=</span>.<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">    <span class="dt">panel=</span><span class="cf">function</span>(x,y,...) {</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">        <span class="kw">panel.smooth</span>(x,y,<span class="dt">span=</span>.<span class="dv">8</span>,<span class="dt">iter=</span><span class="dv">5</span>,...)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">        <span class="kw">abline</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    } </a>
<a class="sourceLine" id="cb15-6" data-line-number="6"> )</a></code></pre></div>
<p>(Be sure to include the trailing curvy bracket and parenthesis when copying and pasting.)</p>
<p><strong>NOTE</strong>: RStudio on the Mac may produce the error message “<code>Error in plot.new(): figure margins too large</code>” and not plot the “shingles” in the top and right-hand margins. If that happens, the workaround is to write the output to a file:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">pdf</span>(<span class="st">&quot;coplot.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">coplot</span>(tann <span class="op">~</span><span class="st"> </span>elev <span class="op">|</span><span class="st"> </span>lon <span class="op">*</span><span class="st"> </span>lat, <span class="dt">number=</span><span class="dv">5</span>, <span class="dt">overlap=</span>.<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="dt">panel=</span><span class="cf">function</span>(x,y,...) {</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">    <span class="kw">points</span>(x,y,...)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">    <span class="kw">abline</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  } </a>
<a class="sourceLine" id="cb16-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="kw">dev.off</span>()</a></code></pre></div>
<p>The <code>pdf(&quot;coplot.pdf&quot;)</code> function opens a file in your working directory called <code>coplot.pdf</code> and writes the plot into that file. The <code>dev.off()</code> function closes that file, and you can then view it using Acrobat or Preview.</p>
<p>Each panel on the diagram shows the relationship between annual average temperature and elevation for a geographical subset of data. The “panel functions” in <code>coplot()</code> allow lowess curves and least-squares lines to be added to the plot to facilitate interpretation. The individual panels, arranged as they are here, form a map of scatter diagrams.</p>
<blockquote>
<p>Q2: How do latitude and longitude influence the relationship between temperature and elevation? Is the relationship “stationary” across the state (i.e. same relationship everywhere), or are there spatial variations in the strength or form of the relationship.</p>
</blockquote>
<p><br> Experiment with the number of coplot shingles and degree of overlap of each (the number and overlap arguments in the coplot() function.</p>
<blockquote>
<p>Q3: How do these two parameters control the appearance of the resulting diagram?</p>
</blockquote>
<blockquote>
<p>Q4: What are the tradeoffs involved in changing the number of shingles. Is there a particular choice that seems to work better?</p>
</blockquote>
<p><br> Detach <code>orstationc</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">detach</span>(orstationc)</a></code></pre></div>
<p><strong>4. Lattice plots</strong></p>
<p>This set of plots and analyses use a data set of glacial-cirque locations in Oregon collected by Deb Sea several years ago for a class project. The data set may be found here: <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/csv/cirques.csv">[cirques.csv]</a> and the data can be read into the R workspace after downloading as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">csvfile &lt;-<span class="st"> &quot;/Users/bartlein/Documents/geog495/data/csv/cirques.csv&quot;</span> </a>
<a class="sourceLine" id="cb18-2" data-line-number="2">cirques &lt;-<span class="st"> </span><span class="kw">read.csv</span>(csvfile)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw">attach</span>(cirques)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw">names</span>(cirques)</a></code></pre></div>
<p>The variables are an index number (<code>Cirque</code>), location (<code>Lat</code>, <code>Lon</code>), elevation in meters (<code>Elev</code>), a region indicator (which can be plotted to discover what the regions are; <code>Region</code>) and a 0/1 variable that indicates whether each cirque is occupied by a glacier (<code>Glacier = G</code>) or not (<code>Glacier = U</code>).</p>
<p>(Should you wish to also do nicer maps of these data, here are the links to the appropriate shapefile components: <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/cirques.dbf">[.dbf]</a> <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/cirques.shp">[.shp]</a> <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/cirques.shx">[.shx]</a>) <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/shp/cirques.prj">[.prj]</a></p>
<p>See Section 7 of the “Mutivariate Plots” lecture for maps of the data.</p>
<p>The aim of the analysis is to examine the spatial variations in the elevations of the cirque basins, in order to infer what might be controlling their distribution. From theory, we might expect that the “glaciation threshold” or elevation at which glaciers may form, should be lower where it is cooler and moister, and higher where it is warm and dry. The question that can be asked here is whether the Oregon cirque distributions conform to this idea, based on examining that distribution.</p>
<p>Produce a 3-D scatter plot of cirque elevation as a function of latitude and longitude, with the points colored by Glacier</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">cloud</span>(Elev <span class="op">~</span><span class="st"> </span>Lon<span class="op">*</span>Lat, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">col=</span><span class="kw">as.integer</span>(Glacier)<span class="op">+</span><span class="dv">1</span>)</a></code></pre></div>
<p>The glaciated cirque basins should appear in red. Relative to all cirque basins, note where the glaciated ones tend to occur.</p>
<p>Create and plot some conditioning variables:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">Lat2 &lt;-<span class="st"> </span><span class="kw">equal.count</span>(Lat,<span class="dv">4</span>,.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">Lon2 &lt;-<span class="st"> </span><span class="kw">equal.count</span>(Lon,<span class="dv">4</span>,.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">plot</span>(Lat2)</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="kw">plot</span>(Lon2)</a></code></pre></div>
<p>Using those conditioning variables, construct a Lattice-type coplot of elevation as a function of longitude, given (or condtioned by) latitude:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Cirque elevation as a function of longitude, given latitude</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">plot2 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(Elev <span class="op">~</span><span class="st"> </span>Lon <span class="op">|</span><span class="st"> </span>Lat2,</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">    <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">    <span class="dt">panel =</span> <span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">        <span class="kw">panel.grid</span>(<span class="dt">v=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">        <span class="kw">panel.xyplot</span>(x, y)</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">        <span class="kw">panel.loess</span>(x, y, <span class="dt">span =</span> <span class="fl">.8</span>, <span class="dt">degree =</span> <span class="dv">1</span>, <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>)</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">        <span class="kw">panel.abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">    },</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">    <span class="dt">xlab =</span> <span class="st">&quot;Longitude&quot;</span>,</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">    <span class="dt">ylab =</span> <span class="st">&quot;Elevation (m)&quot;</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="kw">print</span>(plot2)</a></code></pre></div>
<p>The title bar of each panel is shaded to indicate (by means of the darker shading) the particular range of latitudes of the points that are plotted on each panel. The leftmost panel contains the observations from the lowest latitude band, while the rightmost contains those from the highest latitude band.</p>
<p>Note that the two lines/curves added to the plot (a lowess/loess curve and a straight-line plot) are meant to summarize the relationship within each scatter plot panel, if there is a relationship to be summarized. In other words, the curves may not appear to fit the data very well at all, which is useful to know. In other cases, the curves may help to reveal a relationship that would otherwise be difficult to see. You can eliminate the curves by removing the panel functions panel.xyplot(etc.) and panel.abline(etc.)</p>
<p>Edit the above code, to create a coplot for elevation as a function of latitude, conditioned by longitude. The most convenient way to do this is to copy and past the block of code, make the changes, and run it again.</p>
<blockquote>
<p>Q5: Describe the relationships. (How do cirque elevations vary across the state? Do the relationships conform to the conceptual model described above?)</p>
</blockquote>
<p><br> Produce two other kinds of Trellis plots</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># Lattice stripplot</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">plot4 &lt;-<span class="st"> </span><span class="kw">stripplot</span>(Glacier <span class="op">~</span><span class="st"> </span>Elev <span class="op">|</span><span class="st"> </span>Lat2<span class="op">*</span>Lon2)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw">print</span>(plot4)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co"># Lattice boxplot</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">plot5 &lt;-<span class="st"> </span><span class="kw">bwplot</span>(Glacier <span class="op">~</span><span class="st"> </span>Elev<span class="op">|</span><span class="st"> </span>Lat2<span class="op">*</span>Lon2)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="kw">print</span>(plot5)</a></code></pre></div>
<blockquote>
<p>Q6: Do the additional plots contribute anything to understanding the distribution of cirque elevations?</p>
</blockquote>
<blockquote>
<p>Q7: Describe the distribution of cirques across the state, and suggest what might influence that distribution. It might make sense to take a look at some maps of the climate variables.</p>
</blockquote>
<blockquote>
<p>Q8: Overall, would you say that cirque elevations vary with latitude, longitude and elevation each acting independently, or are there interactions among those controls?</p>
</blockquote>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
